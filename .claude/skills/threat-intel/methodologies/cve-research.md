# CVE Research and Analysis Methodology

**Comprehensive vulnerability intelligence gathering and prioritization**

---

## Research Process

**8-step methodology for complete CVE analysis**

### Step 1: Query NIST NVD for CVE Details

**Primary Source:** https://nvd.nist.gov/vuln/search

**Data to Extract:**
- CVE ID (e.g., CVE-2024-12345)
- Title/Description (vulnerability summary)
- Published Date (when disclosed)
- Last Modified Date (when updated)
- CWE Classification (weakness category)
- Affected Products (CPE enumeration)
- References (vendor advisories, patches, exploits)

**NVD API Usage:**
```bash
curl "https://services.nvd.nist.gov/rest/json/cves/2.0?cveId=CVE-2024-12345"
```

---

### Step 2: Calculate CVSS v3.1 Scores

**CVSS Calculator:** https://www.first.org/cvss/calculator/3.1

**Metrics to Capture:**

**Base Score (Intrinsic characteristics):**
- Attack Vector (AV): Network, Adjacent, Local, Physical
- Attack Complexity (AC): Low, High
- Privileges Required (PR): None, Low, High
- User Interaction (UI): None, Required
- Scope (S): Unchanged, Changed
- Confidentiality Impact (C): None, Low, High
- Integrity Impact (I): None, Low, High
- Availability Impact (A): None, Low, High

**Temporal Score (Time-dependent factors):**
- Exploit Code Maturity: Not Defined, High, Functional, Proof-of-Concept, Unproven
- Remediation Level: Not Defined, Official Fix, Temporary Fix, Workaround, Unavailable
- Report Confidence: Not Defined, Confirmed, Reasonable, Unknown

**Environmental Score (Organization-specific):**
- Modified Base Metrics (adjust base score for your environment)
- CIA Requirements: Not Defined, Low, Medium, High

**Output:** Vector string + numeric score
**Example:** `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H` = 9.8 (Critical)

---

### Step 3: Check CISA KEV Catalog for Active Exploitation

**CISA KEV Catalog:** https://www.cisa.gov/known-exploited-vulnerabilities-catalog

**Check if CVE is in KEV catalog:**
- Download CSV: https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv
- Search for CVE ID
- If found: Note Due Date and Required Action

**KEV Status Implications:**
- **IN KEV:** Active exploitation confirmed in the wild - HIGHEST PRIORITY
- **NOT IN KEV:** No confirmed active exploitation (does not mean safe, just not actively exploited yet)

**Remediation Timeline (if in KEV):**
- Federal agencies: MUST remediate by Due Date (typically 14-21 days)
- Private sector: Use Due Date as recommended timeline

---

### Step 4: Review EPSS Probability Scores

**EPSS API:** https://api.first.org/data/v1/epss?cve=CVE-2024-12345

**Metrics:**
- **EPSS Probability:** 0.0-1.0 (likelihood of exploitation in next 30 days)
- **EPSS Percentile:** Comparison to all CVEs (e.g., 98th percentile = top 2%)

**Interpretation:**
- **High EPSS (>0.5):** High likelihood of exploitation attempt
- **Low EPSS (<0.1):** Low likelihood (but still possible if targeted)

**Usage:** Combine with CVSS for prioritization
- High CVSS + High EPSS = Immediate priority
- High CVSS + Low EPSS = Important but less urgent
- Low CVSS + High EPSS = Monitor (potential widespread exploitation)

---

### Step 5: Map to CWE Weakness Categories

**CWE Database:** https://cwe.mitre.org/

**Extract from NVD:**
- CWE ID(s) (e.g., CWE-89)
- CWE Name (e.g., SQL Injection)
- CWE Description

**Use CWE for:**
- Root cause analysis (what went wrong)
- Pattern identification (similar vulnerabilities)
- Detection strategy (how to find similar issues)
- Prevention guidance (how to avoid in future)

---

### Step 6: Identify Affected Products and Versions

**From NVD CPE (Common Platform Enumeration):**
```
cpe:2.3:a:apache:struts:2.5.0:*:*:*:*:*:*:*
        │   │      │      │
     Vendor Product Version
```

**Document:**
- Vendor name
- Product name
- Affected versions (specific range)
- Fixed versions (patched releases)
- Platforms (OS, architecture)

**Cross-Reference:**
- Vendor security advisories
- Product release notes
- Package manager vulnerability databases (Snyk, GitHub Advisory)

---

### Step 7: Research Proof-of-Concept Availability

**Check for Public Exploits:**

**Sources:**
1. **Exploit-DB:** https://www.exploit-db.com/
2. **GitHub:** Search for CVE ID in code repositories
3. **Metasploit:** Check if exploit module exists
4. **Packet Storm:** https://packetstormsecurity.com/
5. **0day.today:** https://0day.today/

**Document:**
- Public PoC availability (Yes/No)
- PoC source (Exploit-DB, GitHub, etc.)
- Exploit maturity (concept vs weaponized)
- Metasploit module (module name if exists)
- Technical complexity (low/medium/high)

**Implications:**
- **Public PoC exists:** Significantly higher exploitation risk
- **Metasploit module exists:** Script kiddies can exploit with minimal skill
- **No public PoC:** Lower immediate risk (but threat actors may have private exploits)

---

### Step 8: Document Mitigation and Patch Status

**Mitigation Research:**

**Primary:**
- Vendor-provided patch (version upgrade)
- Security update package

**Temporary/Workaround:**
- Configuration changes
- Firewall rules
- WAF signatures
- IDS/IPS signatures

**Detection:**
- Log signatures
- SIEM rules
- EDR detection logic
- Network traffic patterns

**Output Format:**
```markdown
## Mitigation

**Patch:**
- Vendor: Apache Software Foundation
- Fixed Versions: Struts 2.5.33, 6.3.0
- Patch URL: https://struts.apache.org/announce-2024#a20241101
- Release Date: 2024-11-01

**Workaround (if patch unavailable):**
- Disable OGNL expression evaluation in struts.xml
- Restrict access to admin interfaces
- Deploy WAF with anti-deserialization rules

**Detection:**
- WAF Signatures: ModSecurity CRS 3.3+, AWS WAF
- IDS: Snort SID 12345, Suricata ET ID 67890
- Log Pattern: Search for "ognl" in POST request bodies
- SIEM Query: `http_method:POST AND request_body:*ognl*`

**Validation:**
- Scan with: Nessus, OpenVAS, Nuclei
- Test with: POC script from Exploit-DB
- Monitor: Application logs for exploitation attempts
```

---

## Deliverables

**CVE Intelligence Report includes:**

1. **Executive Summary** (1-2 paragraphs)
2. **CVE Metadata** (ID, title, dates, CWE, CVSS)
3. **CISA KEV Status** (in catalog + due date, or not in catalog)
4. **EPSS Exploitability** (probability + percentile)
5. **Affected Products** (vendor, product, versions, platforms)
6. **Exploitation Status** (public PoC, Metasploit, active campaigns)
7. **Mitigation Guidance** (patch, workaround, detection, validation)
8. **MITRE ATT&CK Mapping** (tactics, techniques)
9. **Recommendations** (priority, timeline, actions)

**Time Estimate:**
- Standard CVE research: 15-30 minutes per CVE
- Deep CVE analysis with exploit research: 45-60 minutes per CVE

---

**Related:**
- `reference/standards.md` - NVD, CISA KEV, CVSS, EPSS, CWE frameworks
- `templates/cve-research-report.md` - CVE report template
- `methodologies/attck-mapping.md` - Map CVE to MITRE ATT&CK techniques
- `workflows/threat-intelligence.md` - Phase 2: CVE research workflow
